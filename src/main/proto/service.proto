syntax = "proto3";

package org.example.grpc;

option java_multiple_files = true;
option java_package = "org.example.grpc";

service FlightService {
  rpc GetPublicKey (Empty) returns (PublicKeyResponse);

  rpc SetSessionKey (SessionKeyRequest) returns (StatusResponse);

  rpc StreamFlights (stream EncryptedPacket) returns (StatusResponse);
}

message Empty {}

message PublicKeyResponse {
  bytes pemKey = 1;
}

message SessionKeyRequest {
  bytes wrappedKey = 1;
}

message EncryptedPacket {
  bytes iv = 1;
  bytes encryptedData = 2;
}

message StatusResponse {
  bool success = 1;
  string message = 2;
}

message FlightData {
  string flightNo = 1;
  string airlineName = 2;
  string aircraftModel = 3;
  string depCity = 4;
  string depCode = 5;
  string arrCity = 6;
  string arrCode = 7;
  string passengerName = 8;
  string passportNo = 9;
  string flightDate = 10;
}